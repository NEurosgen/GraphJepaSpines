seed: 52

# Network configuration
network:
  _target_: src.models.jepa.LeJEPA
  encoder:
    _target_: src.models.encoder.GraphGinEncoder
    in_channels: 21  # Matches dataset feature dimension
    out_channels: 64
    num_layers: 6
  predictor:
    _target_: src.models.jepa.CrossAttentionPredictor
    hidden_dim: 64
    pos_dim: 3
    num_heads: 2
    dropout: 0.1
  lambd: 0.1
  num_slices: 128
  ema: 0.996
  

# Training configuration
training:
  learning_rate: 1e-2
  weight_decay: 1e-5
  max_epochs: 100
  optimizer:
    _target_: torch.optim.AdamW
    weight_decay: ${training.weight_decay}
  scheduler:    # Для соотвествия с экспериментом
    _target_: torch.optim.lr_scheduler.CosineAnnealingLR
    T_max: ${training.max_epochs}

# Trainer configuration
trainer:
  max_epochs: ${training.max_epochs}
  accelerator: "gpu"
  devices: 1
  log_every_n_steps: 10
  

# DataModule configuration
datamodule:
  _target_: src.data_utils.datamodule.GraphDataModule
  dataset:
    _target_: src.data_utils.datamodule.GraphDataSet
    path: "/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/notebooks/graph_dataset"
    stats_path: '/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/GIT_Graph_refactor/data/stats/'
    class_path: '/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/public_cave_ground_truth_cell_types_with_nucleus.csv'
  #features: [0,4,5,6,7,13,14,15,17,19,20]
  batch_size: 32
  num_workers: 2
  knn: 4
  mask_ratio: 0.1
  seed: ${seed}
  ratio: [0.7, 0.2, 0.1]


representation:
  enabled: true
  batch_size: 32
  datasets:
    - path: "/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/notebooks/graph_dataset_output_ab"
      label: 0
    - path: "/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/notebooks/graph_dataset_output_wt"
      label: 1
  # Доступные эстиматоры: rank_me, isotropy, uniformity, cluster, recall, alignment
  #features: [0,4,5,6,7,13,14,15,17,19,20]
  estimators:
    - rank_me
    - isotropy
    - uniformity

  stats_path: "/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/GIT_Graph_refactor/data/stats_9009/"

# Classifier training (linear probe on frozen JEPA encoder)
classifier:
  checkpoint_path: "/home/eugen/Desktop/CodeWork/Projects/Diplom/notebooks/GIT_Graph_refactor/lightning_logs/version_189/checkpoints/epoch=24-step=55525.ckpt"
  num_classes: 2
  learning_rate: 1e-3
  max_epochs: 1
  sigma: 1.0
